<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FreeFire Information Website</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#0d0d0d; color:#fff; overflow-x:hidden;}
    /* Intro Screen */
    #intro { position:fixed; top:0; left:0; width:100%; height:100%; background:#000; display:flex; justify-content:center; align-items:center; flex-direction:column; z-index:1000; transition:opacity 0.5s;}
    #intro h1 { color:#ff9800; font-size:3em; animation:fadeIn 2s ease-in-out;}
    @keyframes fadeIn { 0%{opacity:0} 50%{opacity:1} 100%{opacity:1} }

    h1 { text-align:center; color:#ff9800; margin-top:20px;}
    input, button { padding:10px; margin:5px 0; width:100%; max-width:300px; border-radius:5px; border:none; }
    button { background:#ff9800; color:#000; font-weight:bold; cursor:pointer; transition:0.3s; }
    button:hover { background:#e68900; }
    .card { background:#1a1a1a; padding:20px; margin:20px auto; border-radius:12px; max-width:700px; box-shadow:0 0 15px rgba(255,152,0,0.3); opacity:0; transform:translateY(20px); transition: all 0.3s, box-shadow 0.3s, border 0.3s; cursor:pointer; border:2px solid transparent;}
    .card.visible { opacity:1; transform:translateY(0);}
    .card:hover { box-shadow:0 0 30px rgba(255,180,0,0.7);}
    .card.active { background:#222; box-shadow:0 0 40px rgba(255,180,0,1); border:2px solid #ff9800;}
    .card h2 { margin-top:0; color:#ff9800; border-bottom:1px solid #444; padding-bottom:5px; }
    .field { margin:8px 0; }
    .field b { color:#ff9800; }
    #about { text-align:center; margin-top:20px; font-size:0.9em; color:#aaa;}
  </style>
</head>
<body>

  <!-- Intro Screen -->
  <div id="intro">
    <h1>Welcome To FF Info Web</h1>
    <p style="color:#fff;">Created By Suraj Bhai</p>
  </div>

  <h1>ðŸ”¥ Free Fire Profile Viewer ðŸ”¥</h1>
  <div style="text-align:center;">
    <input type="text" id="uid" placeholder="Enter UID">
    <button onclick="fetchInfo()">Get Info</button>
  </div>

  <div id="result"></div>

  <div id="about">
    About: Full Free Fire account info viewer by UID.<br>
    Created & Coded By: Suraj Jangid
  </div>

  <script>
    setTimeout(()=>{
      document.getElementById('intro').style.opacity='0';
      setTimeout(()=>{document.getElementById('intro').style.display='none';},500);
    },2000);

    async function fetchInfo(){
      const uid = document.getElementById('uid').value.trim();
      if(!uid){ alert("Please enter your Free Fire UID! Example: 8080519000"); return;}
      try{
        const res = await fetch(`/api/fetchinfo?uid=${uid}`);
        if(!res.ok){ alert("API Error! Check console."); return; }
        const data = await res.json();
        console.log(data);

        const r = document.getElementById('result');
        r.innerHTML = "";

        if(data.status === "error"){
          alert("Invalid UID! Player not found or does not exist in Free Fire.");
          return;
        }

        function createCard(title, fields, avatarUrl=null){
          let html=`<div class="card"><h2>${title}</h2>`;
          
          // Agar avatarUrl milti hai to image dikhayega
          if(avatarUrl){
            html+=`<div style="text-align:center; margin-bottom:15px;">
                      <img src="${avatarUrl}" alt="Avatar" style="width:120px;height:120px;border-radius:50%;border:3px solid #ff9800;">
                   </div>`;
          }

          for(const [k,v] of Object.entries(fields)){
            html+=`<div class="field"><b>${k}:</b> ${v}</div>`;
          }
          html+="</div>";
          r.innerHTML+=html;
          const card = r.lastChild;
          card.classList.add('visible');

          card.addEventListener('click', ()=>{
            document.querySelectorAll('.card').forEach(c=>c.classList.remove('active'));
            card.classList.add('active');
          });
        }

        // Avatar URL banane ka logic
        let avatarImg = null;
        if(data.profileInfo?.avatarId){
          avatarImg = `https://gunfire.vercel.app/api/images?object=${data.profileInfo.avatarId}`;
        } else {
          avatarImg = "https://i.ibb.co/4pDNDk1/default-avatar.png"; // default example image
        }

        // Basic Info (with Avatar)
        createCard("Basic Info", {
          "Nickname": data.basicInfo?.nickname || "N/A",
          "UID": data.basicInfo?.accountId || "N/A",
          "Level": data.basicInfo?.level || "N/A",
          "Rank": `${data.basicInfo?.rank || "N/A"} (Points: ${data.basicInfo?.rankingPoints || "N/A"})`,
          "CS Rank": `${data.basicInfo?.csRank || "N/A"} (Points: ${data.basicInfo?.csRankingPoints || "N/A"})`,
          "Region": data.basicInfo?.region || "N/A",
          "Likes": data.basicInfo?.liked || "N/A",
          "Title": data.basicInfo?.title || "N/A"
        }, avatarImg);

        // Captain Info
        createCard("Captain Info", {
          "Nickname": data.captainBasicInfo?.nickname || "N/A",
          "Level": data.captainBasicInfo?.level || "N/A",
          "Rank": `${data.captainBasicInfo?.rank || "N/A"} (Points: ${data.captainBasicInfo?.rankingPoints || "N/A"})`,
          "Likes": data.captainBasicInfo?.liked || "N/A"
        });

        // Clan Info
        createCard("Clan Info", {
          "Clan Name": data.clanBasicInfo?.clanName || "N/A",
          "Clan Level": data.clanBasicInfo?.clanLevel || "N/A",
          "Members": `${data.clanBasicInfo?.currentMembers || "0"}/${data.clanBasicInfo?.maxMembers || "0"}`
        });

        // Honor Score
        createCard("Honor Score", {
          "Score": data.creditScoreInfo?.score || "N/A",
          "Status": data.creditScoreInfo?.status || "N/A",
          "Reason": data.creditScoreInfo?.reason || "N/A"
        });

        // Pet Info
        createCard("Pet Info", {
          "Pet ID": data.petInfo?.petId || "N/A",
          "Level": data.petInfo?.level || "N/A",
          "Selected Skill ID": data.petInfo?.selectedSkillId || "N/A"
        });

        // Profile Info
        createCard("Profile Info", {
          "Avatar ID": data.profileInfo?.avatarId || "N/A",
          "Equipped Skills": (data.profileInfo?.equippedSkills || []).join(", "),
          "Primary Weapon": data.profileInfo?.pvePrimaryWeapon || "N/A"
        });

      } catch(err){
        console.error(err);
        alert("Error Fetching Data. Please try again or contact t.me/Zorvaxo for support.");
      }
    }
  </script>
</body>
</html>