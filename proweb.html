<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ProBrowser ‚Äî Web Prototype</title>
<style>
  :root{
    --bg:#0f1724; --panel:#0b1220; --muted:#9aa6b2; --accent:#4f46e5; --glass: rgba(255,255,255,0.03);
    --light-bg:#f7fafc; --light-panel:#ffffff; --light-text:#0b1220;
  }
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Helvetica,Arial;}
  body.pro-dark{background:var(--bg); color:#e6eef6;}
  body.pro-light{background:var(--light-bg); color:var(--light-text);}
  .app{display:flex;flex-direction:column;height:100vh;gap:8px;padding:10px;}
  /* top chrome */
  .topbar{display:flex;align-items:center;gap:8px;padding:6px;border-radius:10px;background:var(--panel);box-shadow:0 6px 18px rgba(2,6,23,0.6);}
  .left-controls{display:flex;gap:6px;align-items:center;margin-right:6px;}
  .btn{background:var(--glass);border:0;padding:8px;border-radius:8px;cursor:pointer;color:inherit;font-weight:600;}
  .btn:active{transform:translateY(1px);}
  .address-wrap{flex:1;display:flex;align-items:center;gap:8px;}
  input.address{flex:1;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;outline:none;}
  .actions{display:flex;gap:6px;}
  .tabs{display:flex;gap:6px;padding:6px;border-radius:10px;background:rgba(255,255,255,0.02);overflow:auto;}
  .tab{padding:8px 12px;border-radius:8px;background:transparent;cursor:pointer;white-space:nowrap;display:flex;gap:8px;align-items:center;}
  .tab.active{background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));box-shadow:0 4px 12px rgba(2,6,23,0.6);}
  .tab .close{margin-left:6px;font-weight:700;cursor:pointer;opacity:0.7;}
  .bookmark-bar{display:flex;gap:8px;padding:6px;overflow:auto;border-radius:8px;background:rgba(255,255,255,0.01);}
  .bookmark{padding:6px 10px;border-radius:8px;background:transparent;border:1px dashed rgba(255,255,255,0.03);cursor:pointer;display:flex;gap:6px;align-items:center;}
  .pane{flex:1;background:#fff;border-radius:12px;overflow:hidden;border:1px solid rgba(0,0,0,0.06);}
  body.pro-dark .pane{background:#08101a;border:1px solid rgba(255,255,255,0.03);}
  iframe#view{width:100%;height:100%;border:0;}
  .status{font-size:12px;color:var(--muted);padding:6px 8px;}
  .small{font-size:12px;color:var(--muted);}
  /* responsive */
  @media (max-width:700px){ .topbar{flex-direction:column;align-items:stretch} .address-wrap{order:2} .tabs{order:1} }
</style>
</head>
<body class="pro-dark">
<div class="app">
  <div class="topbar" role="toolbar" aria-label="ProBrowser toolbar">
    <div class="left-controls">
      <button class="btn" id="backBtn" title="Back (Alt+Left)">&larr;</button>
      <button class="btn" id="forwardBtn" title="Forward (Alt+Right)">&rarr;</button>
      <button class="btn" id="reloadBtn" title="Reload">‚ü≥</button>
      <button class="btn" id="newTabBtn" title="New Tab (Ctrl+T)"> + Tab</button>
    </div>

    <div class="address-wrap">
      <input id="addressInput" class="address" placeholder="Search or enter URL (Ctrl+L)" />
      <div class="actions">
        <button class="btn" id="bookmarkBtn" title="Bookmark this page">‚òÖ</button>
        <button class="btn" id="themeBtn" title="Toggle Dark/Light">üåó</button>
        <button class="btn" id="incognitoBtn" title="Toggle Incognito">üï∂Ô∏è</button>
        <button class="btn" id="menuBtn" title="Menu">‚ò∞</button>
      </div>
    </div>
  </div>

  <div class="tabs" id="tabs"></div>

  <div class="bookmark-bar" id="bookmarkBar" aria-label="Bookmark bar"></div>

  <div class="pane" id="pane">
    <iframe id="view" src="https://example.com" sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>
  </div>

  <div class="status">
    <span id="statusText">Ready ‚Ä¢ ProBrowser prototype</span>
    <span style="float:right" class="small" id="incognitoLabel"></span>
  </div>
</div>

<script>
/* ProBrowser - simple tabbed iframe browser */
(function(){
  // State
  let tabs = []; // {id, title, url, history:[], historyIndex}
  let activeTabId = null;
  let incognitoMode = false;
  const addr = document.getElementById('addressInput');
  const view = document.getElementById('view');
  const tabsEl = document.getElementById('tabs');
  const bookmarkBar = document.getElementById('bookmarkBar');
  const statusText = document.getElementById('statusText');
  const incognitoLabel = document.getElementById('incognitoLabel');

  // Storage keys
  const KEY_BOOKMARKS = 'probrowser_bookmarks_v1';
  const KEY_HISTORY = 'probrowser_history_v1';
  const KEY_THEME = 'probrowser_theme_v1';

  // Utilities
  function uid(){ return 't'+Math.random().toString(36).slice(2,9); }
  function ensureUrl(s){
    if(!s) return '';
    s = s.trim();
    // If it's likely a search query (has spaces) or doesn't contain a dot -> google search
    if(/\s/.test(s) || !/[.]/.test(s)) return 'https://www.google.com/search?q='+encodeURIComponent(s);
    if(!/^https?:\/\//i.test(s)) s = 'https://' + s;
    return s;
  }
  function saveBookmarks(list){ localStorage.setItem(KEY_BOOKMARKS, JSON.stringify(list||[])); }
  function loadBookmarks(){ try { return JSON.parse(localStorage.getItem(KEY_BOOKMARKS))||[] } catch(e){ return []; } }
  function addHistory(url){
    if(incognitoMode) return;
    try {
      const h = JSON.parse(localStorage.getItem(KEY_HISTORY))||[];
      h.unshift({url: url, time: Date.now()});
      localStorage.setItem(KEY_HISTORY, JSON.stringify(h.slice(0,500)));
    } catch(e){}
  }

  // Bookmarks
  function renderBookmarks(){
    const bs = loadBookmarks();
    bookmarkBar.innerHTML = '';
    if(bs.length===0){
      const p = document.createElement('div');
      p.className='bookmark small';
      p.textContent = 'No bookmarks ‚Äî click ‚òÖ to add';
      bookmarkBar.appendChild(p);
      return;
    }
    bs.forEach((b, i)=>{
      const el = document.createElement('div');
      el.className='bookmark';
      el.title = b.title || b.url;
      el.innerHTML = `<span>${b.title||b.url}</span> <button data-i="${i}" style="margin-left:8px">‚úï</button>`;
      el.addEventListener('click', (ev)=>{
        if(ev.target.tagName==='BUTTON'){ removeBookmark(i); ev.stopPropagation(); return; }
        openUrlInActiveTab(b.url);
      });
      bookmarkBar.appendChild(el);
    });
  }
  function addBookmark(url, title){
    if(incognitoMode) return alert('Incognito: not saving bookmark.');
    const bs = loadBookmarks();
    if(bs.find(b=>b.url===url)) return;
    bs.unshift({url, title: title||url});
    saveBookmarks(bs.slice(0,200));
    renderBookmarks();
  }
  function removeBookmark(i){
    const bs = loadBookmarks();
    bs.splice(i,1);
    saveBookmarks(bs);
    renderBookmarks();
  }

  // Tabs
  function createTab(url, opts={}){
    const id = uid();
    const tab = {id, title: opts.title || 'New Tab', url: url || 'https://example.com', history:[url||'https://example.com'], historyIndex:0};
    tabs.push(tab);
    activeTabId = id;
    renderTabs();
    loadTabInFrame(tab);
    saveStateToUI();
    return tab;
  }
  function closeTab(id){
    const idx = tabs.findIndex(t=>t.id===id);
    if(idx===-1) return;
    tabs.splice(idx,1);
    if(tabs.length===0) { createTab('https://example.com'); return; }
    if(activeTabId===id){
      const newActive = tabs[Math.max(0, idx-1)];
      activeTabId = newActive.id;
      loadTabInFrame(newActive);
    }
    renderTabs();
  }
  function switchToTab(id){
    const t = tabs.find(x=>x.id===id);
    if(!t) return;
    activeTabId = id;
    renderTabs();
    loadTabInFrame(t);
  }
  function renderTabs(){
    tabsEl.innerHTML = '';
    tabs.forEach(t=>{
      const el = document.createElement('div');
      el.className = 'tab' + (t.id===activeTabId ? ' active':'' );
      el.innerHTML = `<span class="title">${t.title || t.url}</span><span class="close">‚úï</span>`;
      el.addEventListener('click', (ev)=>{
        if(ev.target.classList.contains('close')){ closeTab(t.id); ev.stopPropagation(); return; }
        switchToTab(t.id);
      });
      tabsEl.appendChild(el);
    });
  }

  // Frame load and events
  function loadTabInFrame(tab){
    try {
      view.src = tab.url;
      addr.value = tab.url;
      statusText.textContent = 'Loading: ' + tab.url;
    } catch(e){ console.error(e); }
  }
  view.addEventListener('load', ()=>{
    statusText.textContent = 'Loaded ‚Ä¢ ' + (getActiveTab()?.url||'');
    // try to read title (only works for same-origin)
    try {
      const doc = view.contentDocument || view.contentWindow.document;
      const title = doc && doc.title;
      const active = getActiveTab();
      if(active && title) { active.title = title; renderTabs(); }
    } catch(e){}
  });

  // Active tab helper
  function getActiveTab(){ return tabs.find(t=>t.id===activeTabId); }

  // Navigation functions
  function openUrlInActiveTab(raw){
    const url = ensureUrl(raw);
    const t = getActiveTab();
    if(!t) { createTab(url); return; }
    t.url = url;
    // update history
    if(t.history[t.historyIndex] !== url){
      t.history = t.history.slice(0, t.historyIndex+1);
      t.history.push(url);
      t.historyIndex = t.history.length - 1;
    }
    loadTabInFrame(t);
    addHistory(url);
  }
  function goBack(){
    const t = getActiveTab();
    if(!t) return;
    if(t.historyIndex > 0){ t.historyIndex--; t.url = t.history[t.historyIndex]; loadTabInFrame(t); }
  }
  function goForward(){
    const t = getActiveTab();
    if(!t) return;
    if(t.historyIndex < t.history.length - 1){ t.historyIndex++; t.url = t.history[t.historyIndex]; loadTabInFrame(t); }
  }
  function reload(){
    // simple reload
    view.src = view.src;
  }

  // Theme
  function setTheme(theme){
    if(theme==='light'){ document.body.classList.remove('pro-dark'); document.body.classList.add('pro-light'); localStorage.setItem(KEY_THEME,'light'); }
    else { document.body.classList.remove('pro-light'); document.body.classList.add('pro-dark'); localStorage.setItem(KEY_THEME,'dark'); }
  }
  function toggleTheme(){ setTheme(document.body.classList.contains('pro-dark') ? 'light' : 'dark'); }

  // Incognito
  function toggleIncognito(){
    incognitoMode = !incognitoMode;
    incognitoLabel.textContent = incognitoMode ? 'Incognito ON' : '';
    if(incognitoMode) alert('Incognito: history & bookmark saving paused for this session.');
  }

  // Keyboard shortcuts
  document.addEventListener('keydown', (e)=>{
    if(e.ctrlKey && e.key.toLowerCase()==='t'){ e.preventDefault(); createTab('https://www.google.com'); }
    if(e.ctrlKey && e.key.toLowerCase()==='w'){ e.preventDefault(); if(getActiveTab()) closeTab(getActiveTab().id); }
    if(e.ctrlKey && e.key.toLowerCase()==='l'){ e.preventDefault(); addr.focus(); addr.select(); }
    if(e.altKey && e.key === 'ArrowLeft'){ e.preventDefault(); goBack(); }
    if(e.altKey && e.key === 'ArrowRight'){ e.preventDefault(); goForward(); }
  });

  // UI bindings
  document.getElementById('newTabBtn').addEventListener('click', ()=> createTab('https://www.google.com'));
  document.getElementById('backBtn').addEventListener('click', goBack);
  document.getElementById('forwardBtn').addEventListener('click', goForward);
  document.getElementById('reloadBtn').addEventListener('click', reload);
  document.getElementById('bookmarkBtn').addEventListener('click', ()=>{
    const t = getActiveTab();
    if(!t) return alert('No active tab');
    addBookmark(t.url, t.title || t.url);
  });
  document.getElementById('themeBtn').addEventListener('click', toggleTheme);
  document.getElementById('incognitoBtn').addEventListener('click', toggleIncognito);

  addr.addEventListener('keydown', (e)=>{
    if(e.key==='Enter'){ openUrlInActiveTab(addr.value); e.preventDefault(); }
  });

  // Initial load
  function saveStateToUI(){
    renderTabs();
    renderBookmarks();
  }

  // Load theme from storage
  (function(){
    const t = localStorage.getItem(KEY_THEME) || 'dark';
    setTheme(t);
  })();

  // Create first tab
  createTab('https://example.com');

  // Helpful note: when users click links that try to open new windows, allow-popups in sandbox lets them open.
  // WARNING: Many sites disallow being shown in an iframe (X-Frame-Options). That's a browser security policy ‚Äî nothing we can bypass in JS.
})();
</script>
</body>
</html>